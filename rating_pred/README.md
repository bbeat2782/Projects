# Metacritic User Rating Prediction
Predicting [Metacritic](https://www.metacritic.com/movie) user ratings with data available before a movie is released such as critic reviews, critic ratings, and genre.

# Why it matters?
Often times, you see a bad review from critic and think that you won't enjoy the movie. However, when you go to theater and watch the film for yourself, you find out you actually enjoy the movie. This happened to me when I watched [Extraction 2](https://www.metacritic.com/movie/extraction-2), [Transformers: Rise of the Beasts](https://www.metacritic.com/movie/transformers-rise-of-the-beasts), and [Guardians of the Galaxy Vol. 3](https://www.metacritic.com/movie/guardians-of-the-galaxy-vol-3). The opposite situation also happened for movies like (Renfield)[https://www.metacritic.com/movie/renfield], and sometimes, critic ratings are similar to user ratings such as [Fast X](https://www.metacritic.com/movie/fast-x).

So it seems like how critic and user rate the same movie are different, and that leads to different overall rating. It makes sense because while users generally watch movies for enjoyment, critics expect movies to be an artpiece. Thus, if users take in what critics say about a movie and watch it, they might not get what they want from watching movies. So what if we can expect users ratings with text features from critic reviews? If this is possible, users will have a better understanding of what to expect from movies better than before. 

# Overview
- Websraped movie info, critic reviews, and user reviews from [Metacritic](https://www.metacritic.com/movie) using Python `BeautifulSoup` and stored in `SQLite` database.
- Extracted text sentiment features using `nltk.sentiment.SentimentIntensityAnalyzer` and keywords using `KeyBERT`.
- Analyzed scraped data using `plotly`.
- Improved mean abosolute error by 37.69% when predicting user rating using features from critic reviews compared to assuming user ratings are equal to critic ratings.

## Data Collection

### Original dataset

#### 1. `Movie` dataset
The following is sample rows from `Movie` table that contains all movie information from Metacritic as of 2023 June 16.

|    |             movie_id | movie_title    |   movie_year | movie_summary                                     |   movie_critic_rating |   movie_user_rating |   movie_runtime | movie_genre   | movie_subgenre   | movie_sub2genre   | movie_rating   |   num_critic_pos |   num_critic_mix |   num_critic_neg |   num_user_pos |   num_user_mix |   num_user_neg |
|---:|---------------------:|:---------------|-------------:|:--------------------------------------------------|----------------------:|--------------------:|----------------:|:--------------|:-----------------|:------------------|:---------------|-----------------:|-----------------:|-----------------:|---------------:|---------------:|---------------:|
|  0 | -9222320398758708885 | Generation War |         2014 | In Berlin in 1941, on the eve of Hitler’s inva... |                    57 |                 7.4 |             270 | Drama         | History          | War               | Not Rated      |                4 |               10 |                0 |             34 |              7 |              6 |
|  1 | -9219956025103179742 | Gun Crazy      |         1950 | A well meaning crack shot husband is pressured... |                    74 |                 7.8 |              87 | Drama         | Thriller         | Romance           | Passed         |               11 |                3 |                0 |              4 |              1 |              0 |
|  2 | -9218594262706343994 | Iluzija        |         2006 | Tortured by a tumultuous home life and school ... |                    61 |                 8.1 |             107 | Drama         | None             | None              | Not Rated      |                5 |                2 |                1 |             14 |              0 |              3 |
|  3 | -9216529779443115283 | Fired Up!      |         2009 | Shawn and Nick are top scorers on the Ford Hig... |                    31 |                 5.7 |              90 | Comedy        | None             | None              | PG-13          |                2 |                7 |                9 |             19 |             12 |             10 |
|  4 | -9212162946756563061 | Uncharted      |         2022 | Street-smart Nathan Drake (Tom Holland) is rec... |                    45 |                 6.2 |             116 | Action        | Adventure        | None              | PG-13          |                7 |               33 |                4 |            451 |            169 |            175 |

#### 2. `Critics` dataset
The following is sample rows from `Critics` table that contains all critic review information from the `Movie` table.

|    |   critic_review_id |             movie_id | critic_name        | critic_review                                     | critic_date   |   critic_rating |
|---:|-------------------:|---------------------:|:-------------------|:--------------------------------------------------|:--------------|----------------:|
|  0 |             145643 | -1562356960487678241 | Joshua Land        | The result may be better suited for classroom ... | None          |              60 |
|  1 |             163070 | -8573132570105916711 | Peter Bradshaw     | This is a strong, fierce, heartfelt movie.        | Nov 30, 2022  |              80 |
|  2 |             208027 |  -433637604116680176 | Amy Nicholson      | The screenplay, adapted by Peter Craig, Hillar... | Dec  9, 2021  |              40 |
|  3 |             191435 | -1173456695746148219 | Stephanie Zacharek | Disappointingly tame.                             | None          |              50 |
|  4 |             104342 | -4403818285690920111 | Tim Grierson       | Despite its shortcomings, American Made can be... | Sep 28, 2017  |              72 |

#### 3. `Users` dataset
The following is sample rows from `Users` table that contains all user review information from the `Movie` table.

|    |   user_review_id |             movie_id | user_review                                       | user_date    |   user_rating |
|---:|-----------------:|---------------------:|:--------------------------------------------------|:-------------|--------------:|
|  0 |            74238 | -3697458530605139559 | Begginers is my favorite romantic movie and on... | Oct 26, 2020 |            10 |
|  1 |            11168 |  4282306499439292174 | This movie feels like Imagine walking through ... | Jan 25, 2020 |             9 |
|  2 |           310577 | -6871826492128334529 | The movie might lose its focus in the second h... | Aug 27, 2010 |             6 |
|  3 |           185273 |  7131247308218877535 | The one I really like was tribute to chadwick ... | Feb  2, 2023 |             5 |
|  4 |           164346 |  -781771689375929617 | Enough scares to keep you on the edge of your ... | Dec 21, 2020 |             8 |

## Data Preprocessing

#### 1. Extracting Sentiment Scores
With `SentimentIntensityAnalyzer` from the nltk package, I can extract negative, neutral, positive, and compound score of a text.

```
from nltk.sentiment import SentimentIntensityAnalyzer

sia = SentimentIntensityAnalyzer()
polarity = sia.polarity_scores(text)
```

Running the above code returns the following dictionary format `{'neg': 0.0, 'neu': 1.0, 'pos': 0.0, 'compound': 0.0}`. 

#### 2. Extracting Keywords
With the `KeyBERT` from the keybert package, I can extract keywords from a corpus.

```
kw_model = KeyBERT(model='all-MiniLM-L6-v2')
kw = kw_model.extract_keywords(corpus, 
                               keyphrase_ngram_range=(1, 1), 
                               stop_words='english',
                               use_maxsum=True,
                               top_n=20)
```

From the code block above,
- `keyphrase_ngram_range`: Controls the ngram range of extracted keywords
- `use_maxsum`: Controls the combination of sum of cosine similarity to be the maximum value from 2 x top_n words to diversify the results
- `top_n` : Controls the number of keywords to extract

#### Final Dataframe after Preprocessing

|      |   movie_year |   movie_critic_rating |   movie_user_rating |   num_critic_pos |   num_critic_mix |   num_critic_neg |   mean_neg |   std_neg |   mean_neu |   std_neu |   mean_pos |   std_pos |   mean_compound |   std_compound | Action   | Adventure   | Animation   | Biography   | Comedy   | Crime   | Documentary   | Drama   | Family   | Fantasy   | History   | Horror   | Music   | Musical   | Mystery   | Romance   | Sci-Fi   | Sport   | Thriller   | War   | Approved   | G     | NC-17   | NR    | Not Rated   | PG    | PG-13   | Passed   | R     | TV-14   | TV-G   | TV-MA   | TV-PG   | Unrated   |   lively |   ambitious |   meticulously |   genre |   sophisticated |   elegant |   suspenseful |   elusive |   dull |   mediocre |   hackneyed |   stylish |   skillful |   stylishly |   portray |   innocuous |   archetypal |   strenuous |   artful |   expressive |   underdeveloped |   richly |   ambitiously |   charismatic |   witless |   leisurely |   sublimely |   fiercely |   shallow |   uninspired |   write |   likable |   perform |   entertain |   operatic |   transcend |   unpretentious |   artistic |   fleeting |   earnestly |   eminently |   pensive |   spell |   act |   achieve |   unspeakable |   flourish |   performative |   characterize |   darkly |   wander |   easygoing |   stylistic |   inherent |   voluptuous |   novelistic |   cinematic |   fiendishly |   youthful |   emphasize |   earnestness |   underwhelme |   inoffensive |   shrill |   lean |   succeed |   invaluable |   transcendent |   virtuous |   grindingly |   wistful |   improvisational |   convey |   eclectic |   whimsical |   comic |   melodramatic |   turn |   lackadaisical |   aestheticize |   passably |   sophomoric |   extensive |   pure |   abrupt |   blandly |   irresistible |   dramatic |   distressingly |   mundane |   overact |   satirize |   clichés |   improvise |   languidly |   abandon |   broodingly |   dramatized |   conspicuously |   adjective |   eloquent |   universally |   relentlessly |   unrestrained |   grimly |   filmic |   impenetrable |   excite |   operatically |   playful |   sharp |   swiftly |   expressively |   charitably |   strenuously |   searingly |   comical |   breathtaking |   boring |   torturous |   bombastic |   resonate |   reverential |   unlikable |   virtuosic |   mischievous |   lyrical |   sophisticate |   gradual |   classically |   instructive |   rebellious |   effortlessly |   esoteric |   androgynous |   melancholy |   rueful |   atrocious |   somber |   weary |   lackluster |   meticulous |   superficial |   imaginative |   extraordinary |   meaningful |   seductive |   dullish |   rambunctious |
|-----:|-------------:|----------------------:|--------------------:|-----------------:|-----------------:|-----------------:|-----------:|----------:|-----------:|----------:|-----------:|----------:|----------------:|---------------:|:---------|:------------|:------------|:------------|:---------|:--------|:--------------|:--------|:---------|:----------|:----------|:---------|:--------|:----------|:----------|:----------|:---------|:--------|:-----------|:------|:-----------|:------|:--------|:------|:------------|:------|:--------|:---------|:------|:--------|:-------|:--------|:--------|:----------|---------:|------------:|---------------:|--------:|----------------:|----------:|--------------:|----------:|-------:|-----------:|------------:|----------:|-----------:|------------:|----------:|------------:|-------------:|------------:|---------:|-------------:|-----------------:|---------:|--------------:|--------------:|----------:|------------:|------------:|-----------:|----------:|-------------:|--------:|----------:|----------:|------------:|-----------:|------------:|----------------:|-----------:|-----------:|------------:|------------:|----------:|--------:|------:|----------:|--------------:|-----------:|---------------:|---------------:|---------:|---------:|------------:|------------:|-----------:|-------------:|-------------:|------------:|-------------:|-----------:|------------:|--------------:|--------------:|--------------:|---------:|-------:|----------:|-------------:|---------------:|-----------:|-------------:|----------:|------------------:|---------:|-----------:|------------:|--------:|---------------:|-------:|----------------:|---------------:|-----------:|-------------:|------------:|-------:|---------:|----------:|---------------:|-----------:|----------------:|----------:|----------:|-----------:|----------:|------------:|------------:|----------:|-------------:|-------------:|----------------:|------------:|-----------:|--------------:|---------------:|---------------:|---------:|---------:|---------------:|---------:|---------------:|----------:|--------:|----------:|---------------:|-------------:|--------------:|------------:|----------:|---------------:|---------:|------------:|------------:|-----------:|--------------:|------------:|------------:|--------------:|----------:|---------------:|----------:|--------------:|--------------:|-------------:|---------------:|-----------:|--------------:|-------------:|---------:|------------:|---------:|--------:|-------------:|-------------:|--------------:|--------------:|----------------:|-------------:|------------:|----------:|---------------:|
|  950 |         2018 |                    80 |                 7.3 |               22 |                0 |                0 |  0.0898182 | 0.10236   |   0.741182 | 0.175149  |   0.169    | 0.119288  |        0.259555 |       0.42102  | False    | False       | False       | False       | False    | False   | False         | False   | False    | True      | False     | False    | False   | False     | False     | False     | True     | False   | True       | False | False      | False | False   | False | True        | False | False   | False    | False | False   | False  | False   | False   | False     |        0 |           0 |              0 |       0 |          0.2915 |         0 |             0 |         0 |      0 |          0 |           0 |    0      |     0.3255 |           0 |         0 |           0 |            0 |           0 |        0 |            0 |                0 |   0      |             0 |        0.4243 |         0 |           0 |           0 |          0 |         0 |            0 |  0      |         0 |         0 |      0      |          0 |           0 |               0 |          0 |          0 |           0 |           0 |         0 |       0 |     0 |         0 |             0 |          0 |              0 |              0 |        0 |        0 |      0      |           0 |          0 |            0 |            0 |      0.3182 |            0 |          0 |           0 |             0 |             0 |             0 |        0 |      0 |         0 |            0 |              0 |          0 |            0 |         0 |                 0 |        0 |          0 |           0 |  0      |              0 |      0 |               0 |              0 |          0 |            0 |           0 |      0 |        0 |         0 |              0 |          0 |               0 |         0 |         0 |          0 |         0 |           0 |           0 |         0 |            0 |            0 |               0 |           0 |          0 |             0 |              0 |              0 |        0 |        0 |              0 |        0 |              0 |         0 |  0      |         0 |              0 |            0 |             0 |           0 |         0 |              0 |        0 |           0 |           0 |          0 |             0 |           0 |           0 |             0 |    0      |              0 |         0 |             0 |        0      |            0 |              0 |          0 |             0 |            0 |        0 |           0 |        0 |       0 |            0 |            0 |             0 |             0 |               0 |            0 |      0      |         0 |              0 |
|  154 |         2013 |                    37 |                 4   |                5 |                6 |               10 |  0.0489524 | 0.0697262 |   0.79     | 0.0803847 |   0.161095 | 0.0894974 |        0.438767 |       0.415727 | True     | True        | True        | False       | False    | False   | False         | False   | False    | False     | False     | False    | False   | False     | False     | False     | False    | False   | False      | False | False      | False | False   | False | False       | True  | False   | False    | False | False   | False  | False   | False   | False     |        0 |           0 |              0 |       0 |          0      |         0 |             0 |         0 |      0 |          0 |           0 |    0      |     0      |           0 |         0 |           0 |            0 |           0 |        0 |            0 |                0 |   0      |             0 |        0      |         0 |           0 |           0 |          0 |         0 |            0 |  0.2503 |         0 |         0 |      0      |          0 |           0 |               0 |          0 |          0 |           0 |           0 |         0 |       0 |     0 |         0 |             0 |          0 |              0 |              0 |        0 |        0 |      0      |           0 |          0 |            0 |            0 |      0      |            0 |          0 |           0 |             0 |             0 |             0 |        0 |      0 |         0 |            0 |              0 |          0 |            0 |         0 |                 0 |        0 |          0 |           0 |  0      |              0 |      0 |               0 |              0 |          0 |            0 |           0 |      0 |        0 |         0 |              0 |          0 |               0 |         0 |         0 |          0 |         0 |           0 |           0 |         0 |            0 |            0 |               0 |           0 |          0 |             0 |              0 |              0 |        0 |        0 |              0 |        0 |              0 |         0 |  0      |         0 |              0 |            0 |             0 |           0 |         0 |              0 |        0 |           0 |           0 |          0 |             0 |           0 |           0 |             0 |    0      |              0 |         0 |             0 |        0.2513 |            0 |              0 |          0 |             0 |            0 |        0 |           0 |        0 |       0 |            0 |            0 |             0 |             0 |               0 |            0 |      0      |         0 |              0 |
| 5106 |         2016 |                    44 |                 4.8 |                2 |                8 |                4 |  0.0680714 | 0.0749127 |   0.782357 | 0.150659  |   0.149429 | 0.114685  |        0.222329 |       0.442291 | False    | False       | False       | False       | False    | False   | False         | True    | False    | False     | False     | False    | False   | False     | True      | False     | False    | False   | True       | False | False      | False | False   | False | False       | False | False   | False    | True  | False   | False  | False   | False   | False     |        0 |           0 |              0 |       0 |          0      |         0 |             0 |         0 |      0 |          0 |           0 |    0.3621 |     0      |           0 |         0 |           0 |            0 |           0 |        0 |            0 |                0 |   0      |             0 |        0      |         0 |           0 |           0 |          0 |         0 |            0 |  0      |         0 |         0 |      0      |          0 |           0 |               0 |          0 |          0 |           0 |           0 |         0 |       0 |     0 |         0 |             0 |          0 |              0 |              0 |        0 |        0 |      0      |           0 |          0 |            0 |            0 |      0      |            0 |          0 |           0 |             0 |             0 |             0 |        0 |      0 |         0 |            0 |              0 |          0 |            0 |         0 |                 0 |        0 |          0 |           0 |  0      |              0 |      0 |               0 |              0 |          0 |            0 |           0 |      0 |        0 |         0 |              0 |          0 |               0 |         0 |         0 |          0 |         0 |           0 |           0 |         0 |            0 |            0 |               0 |           0 |          0 |             0 |              0 |              0 |        0 |        0 |              0 |        0 |              0 |         0 |  0      |         0 |              0 |            0 |             0 |           0 |         0 |              0 |        0 |           0 |           0 |          0 |             0 |           0 |           0 |             0 |    0      |              0 |         0 |             0 |        0      |            0 |              0 |          0 |             0 |            0 |        0 |           0 |        0 |       0 |            0 |            0 |             0 |             0 |               0 |            0 |      0.3782 |         0 |              0 |
| 3812 |         2006 |                    57 |                 7.7 |                6 |                5 |                1 |  0.073     | 0.0795647 |   0.677917 | 0.234736  |   0.249167 | 0.185589  |        0.470967 |       0.343457 | False    | False       | False       | False       | False    | False   | True          | False   | False    | False     | False     | False    | False   | False     | False     | False     | False    | False   | False      | False | False      | False | False   | False | True        | False | False   | False    | False | False   | False  | False   | False   | False     |        0 |           0 |              0 |       0 |          0      |         0 |             0 |         0 |      0 |          0 |           0 |    0      |     0      |           0 |         0 |           0 |            0 |           0 |        0 |            0 |                0 |   0.2622 |             0 |        0      |         0 |           0 |           0 |          0 |         0 |            0 |  0      |         0 |         0 |      0.3241 |          0 |           0 |               0 |          0 |          0 |           0 |           0 |         0 |       0 |     0 |         0 |             0 |          0 |              0 |              0 |        0 |        0 |      0.2933 |           0 |          0 |            0 |            0 |      0      |            0 |          0 |           0 |             0 |             0 |             0 |        0 |      0 |         0 |            0 |              0 |          0 |            0 |         0 |                 0 |        0 |          0 |           0 |  0      |              0 |      0 |               0 |              0 |          0 |            0 |           0 |      0 |        0 |         0 |              0 |          0 |               0 |         0 |         0 |          0 |         0 |           0 |           0 |         0 |            0 |            0 |               0 |           0 |          0 |             0 |              0 |              0 |        0 |        0 |              0 |        0 |              0 |         0 |  0      |         0 |              0 |            0 |             0 |           0 |         0 |              0 |        0 |           0 |           0 |          0 |             0 |           0 |           0 |             0 |    0.4796 |              0 |         0 |             0 |        0      |            0 |              0 |          0 |             0 |            0 |        0 |           0 |        0 |       0 |            0 |            0 |             0 |             0 |               0 |            0 |      0      |         0 |              0 |
| 9214 |         2002 |                    48 |                 5.6 |               10 |               19 |                6 |  0.0549032 | 0.101778  |   0.813774 | 0.136019  |   0.131323 | 0.0995089 |        0.274816 |       0.465311 | False    | False       | False       | False       | True     | False   | False         | False   | False    | False     | False     | False    | False   | False     | False     | False     | False    | False   | False      | False | False      | False | False   | False | False       | False | True    | False    | False | False   | False  | False   | False   | False     |        0 |           0 |              0 |       0 |          0      |         0 |             0 |         0 |      0 |          0 |           0 |    0      |     0      |           0 |         0 |           0 |            0 |           0 |        0 |            0 |                0 |   0      |             0 |        0      |         0 |           0 |           0 |          0 |         0 |            0 |  0      |         0 |         0 |      0      |          0 |           0 |               0 |          0 |          0 |           0 |           0 |         0 |       0 |     0 |         0 |             0 |          0 |              0 |              0 |        0 |        0 |      0      |           0 |          0 |            0 |            0 |      0      |            0 |          0 |           0 |             0 |             0 |             0 |        0 |      0 |         0 |            0 |              0 |          0 |            0 |         0 |                 0 |        0 |          0 |           0 |  0.2505 |              0 |      0 |               0 |              0 |          0 |            0 |           0 |      0 |        0 |         0 |              0 |          0 |               0 |         0 |         0 |          0 |         0 |           0 |           0 |         0 |            0 |            0 |               0 |           0 |          0 |             0 |              0 |              0 |        0 |        0 |              0 |        0 |              0 |         0 |  0.2358 |         0 |              0 |            0 |             0 |           0 |         0 |              0 |        0 |           0 |           0 |          0 |             0 |           0 |           0 |             0 |    0      |              0 |         0 |             0 |        0      |            0 |              0 |          0 |             0 |            0 |        0 |           0 |        0 |       0 |            0 |            0 |             0 |             0 |               0 |            0 |      0      |         0 |              0 |

## Visualization

<iframe src="plots/num_review_comparison.html" width="800" height="600"></iframe>
